import{s as Ne,b as ve,e as A,a as P,c as C,d as O,f as U,g as k,h as $,i as W,j as v,k as Be,l as $e,m as Se,n as ce,o as Ge,p as Pe,t as he,q as be,r as Ae,u as Ie,v as Ue,w as Ce,x as fe}from"../chunks/scheduler.Bo5rxkXI.js";import{S as qe,i as Fe,b as we,c as q,a as F,m as j,t as h,d as le,e as g,f as R,g as se}from"../chunks/index.BXG-_PB9.js";import{m as je,e as ye}from"../chunks/mediaQuery.D7fHuHNS.js";import{T as Re,I as He,e as Oe,L as We,E as Je,S as Qe,A as Me}from"../chunks/LoadingCard.N-GFwuGK.js";import{c as pe,a as xe}from"../chunks/index.XqmEgky2.js";import{o as ge,s as Te,E as Ye,C as Le}from"../chunks/WalletsModal.CPqM0ezC.js";import{p as ze}from"../chunks/stores.DC9schWX.js";import{B as ke}from"../chunks/Button.C-W2ZKx2.js";import{B as Ke}from"../chunks/Banner.CVU6Z-xY.js";function De(l,t,n){const e=l.slice();return e[33]=t[n],e}function Xe(l){let t;return{c(){t=he("Reset")},l(n){t=be(n,"Reset")},m(n,e){W(n,t,e)},d(n){n&&k(t)}}}function Ze(l){let t,n;return t=new ke({props:{fullWidth:!0,disabled:l[2]!=="Generate"||!l[0].isAuthenticated,type:"submit",$$slots:{default:[rt]},$$scope:{ctx:l}}}),{c(){q(t.$$.fragment)},l(e){F(t.$$.fragment,e)},m(e,r){j(t,e,r),n=!0},p(e,r){const s={};r[0]&5&&(s.disabled=e[2]!=="Generate"||!e[0].isAuthenticated),r[0]&4|r[1]&32&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){R(t,e)}}}function et(l){let t,n;return t=new ke({props:{fullWidth:!0,type:"button",$$slots:{default:[at]},$$scope:{ctx:l}}}),t.$on("click",l[21]),{c(){q(t.$$.fragment)},l(e){F(t.$$.fragment,e)},m(e,r){j(t,e,r),n=!0},p(e,r){const s={};r[0]&4|r[1]&32&&(s.$$scope={dirty:r,ctx:e}),t.$set(s)},i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){R(t,e)}}}function tt(l){let t,n;return t=new Le({props:{amount:1,variant:"black"}}),{c(){q(t.$$.fragment)},l(e){F(t.$$.fragment,e)},m(e,r){j(t,e,r),n=!0},i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){R(t,e)}}}function nt(l){let t,n='<img src="/spin.gif" alt="spin" class="absolute left-1/2 top-1/2 w-8 -translate-x-1/2 -translate-y-1/2"/>';return{c(){t=A("div"),t.innerHTML=n,this.h()},l(e){t=C(e,"DIV",{class:!0,"data-svelte-h":!0}),Ce(t)!=="svelte-1xxyvx5"&&(t.innerHTML=n),this.h()},h(){$(t,"class","relative w-10")},m(e,r){W(e,t,r)},i:fe,o:fe,d(e){e&&k(t)}}}function rt(l){let t,n,e,r,s,o,c;const a=[nt,tt],i=[];function p(f,_){return _[0]&4&&(n=null),n==null&&(n=!!f[2].includes("...")),n?0:1}return e=p(l,[-1,-1]),r=i[e]=a[e](l),{c(){t=A("div"),r.c(),s=P(),o=he(l[2]),this.h()},l(f){t=C(f,"DIV",{class:!0});var _=O(t);r.l(_),s=U(_),o=be(_,l[2]),_.forEach(k),this.h()},h(){$(t,"class","flex items-center justify-center gap-2")},m(f,_){W(f,t,_),i[e].m(t,null),v(t,s),v(t,o),c=!0},p(f,_){let E=e;e=p(f,_),e!==E&&(se(),h(i[E],1,1,()=>{i[E]=null}),le(),r=i[e],r||(r=i[e]=a[e](f),r.c()),g(r,1),r.m(t,s)),(!c||_[0]&4)&&Ae(o,f[2])},i(f){c||(g(r),c=!0)},o(f){h(r),c=!1},d(f){f&&k(t),i[e].d()}}}function lt(l){let t,n;return t=new Le({props:{amount:1,variant:"black"}}),{c(){q(t.$$.fragment)},l(e){F(t.$$.fragment,e)},m(e,r){j(t,e,r),n=!0},i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){R(t,e)}}}function st(l){let t,n='<img src="/spin.gif" alt="spin" class="absolute left-1/2 top-1/2 w-8 -translate-x-1/2 -translate-y-1/2"/>';return{c(){t=A("div"),t.innerHTML=n,this.h()},l(e){t=C(e,"DIV",{class:!0,"data-svelte-h":!0}),Ce(t)!=="svelte-1xxyvx5"&&(t.innerHTML=n),this.h()},h(){$(t,"class","relative w-10")},m(e,r){W(e,t,r)},i:fe,o:fe,d(e){e&&k(t)}}}function at(l){let t,n,e,r,s,o,c;const a=[st,lt],i=[];function p(f,_){return _[0]&4&&(n=null),n==null&&(n=!!f[2].includes("...")),n?0:1}return e=p(l,[-1,-1]),r=i[e]=a[e](l),{c(){t=A("div"),r.c(),s=P(),o=he(l[2]),this.h()},l(f){t=C(f,"DIV",{class:!0});var _=O(t);r.l(_),s=U(_),o=be(_,l[2]),_.forEach(k),this.h()},h(){$(t,"class","flex items-center justify-center gap-2")},m(f,_){W(f,t,_),i[e].m(t,null),v(t,s),v(t,o),c=!0},p(f,_){let E=e;e=p(f,_),e!==E&&(se(),h(i[E],1,1,()=>{i[E]=null}),le(),r=i[e],r||(r=i[e]=a[e](f),r.c()),g(r,1),r.m(t,s)),(!c||_[0]&4)&&Ae(o,f[2])},i(f){c||(g(r),c=!0)},o(f){h(r),c=!1},d(f){f&&k(t),i[e].d()}}}function Ee(l){let t;return{c(){t=A("div"),this.h()},l(n){t=C(n,"DIV",{class:!0}),O(t).forEach(k),this.h()},h(){$(t,"class","h-[1px] bg-white bg-opacity-20")},m(n,e){W(n,t,e)},d(n){n&&k(t)}}}function ot(l){let t,n,e,r,s;const o=[ct,ut],c=[];function a(i,p){return p[0]&64&&(t=null),t==null&&(t=!!Array.isArray(i[6])),t?0:typeof i[6]=="string"?1:-1}return~(n=a(l,[-1,-1]))&&(e=c[n]=o[n](l)),{c(){e&&e.c(),r=Ie()},l(i){e&&e.l(i),r=Ie()},m(i,p){~n&&c[n].m(i,p),W(i,r,p),s=!0},p(i,p){let f=n;n=a(i,p),n===f?~n&&c[n].p(i,p):(e&&(se(),h(c[f],1,1,()=>{c[f]=null}),le()),~n?(e=c[n],e?e.p(i,p):(e=c[n]=o[n](i),e.c()),g(e,1),e.m(r.parentNode,r)):e=null)},i(i){s||(g(e),s=!0)},o(i){h(e),s=!1},d(i){i&&k(r),~n&&c[n].d(i)}}}function it(l){let t,n;return t=new We({props:{status:l[8],elapsedTime:l[9],message:l[10]}}),{c(){q(t.$$.fragment)},l(e){F(t.$$.fragment,e)},m(e,r){j(t,e,r),n=!0},p(e,r){const s={};r[0]&256&&(s.status=e[8]),r[0]&512&&(s.elapsedTime=e[9]),r[0]&1024&&(s.message=e[10]),t.$set(s)},i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){R(t,e)}}}function ut(l){let t,n;return t=new Me({props:{audioUrl:l[6].audio_url}}),{c(){q(t.$$.fragment)},l(e){F(t.$$.fragment,e)},m(e,r){j(t,e,r),n=!0},p(e,r){const s={};r[0]&64&&(s.audioUrl=e[6].audio_url),t.$set(s)},i(e){n||(g(t.$$.fragment,e),n=!0)},o(e){h(t.$$.fragment,e),n=!1},d(e){R(t,e)}}}function ct(l){let t,n,e=ye(l[6]),r=[];for(let o=0;o<e.length;o+=1)r[o]=Ve(De(l,e,o));const s=o=>h(r[o],1,1,()=>{r[o]=null});return{c(){t=A("ul");for(let o=0;o<r.length;o+=1)r[o].c();this.h()},l(o){t=C(o,"UL",{class:!0});var c=O(t);for(let a=0;a<r.length;a+=1)r[a].l(c);c.forEach(k),this.h()},h(){$(t,"class","grid gap-3 md:grid-cols-2")},m(o,c){W(o,t,c);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(t,null);n=!0},p(o,c){if(c[0]&64){e=ye(o[6]);let a;for(a=0;a<e.length;a+=1){const i=De(o,e,a);r[a]?(r[a].p(i,c),g(r[a],1)):(r[a]=Ve(i),r[a].c(),g(r[a],1),r[a].m(t,null))}for(se(),a=e.length;a<r.length;a+=1)s(a);le()}},i(o){if(!n){for(let c=0;c<e.length;c+=1)g(r[c]);n=!0}},o(o){r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)h(r[c]);n=!1},d(o){o&&k(t),Ue(r,o)}}}function Ve(l){let t,n,e,r;return n=new Me({props:{audioUrl:l[33].audio_url,id:l[33].id}}),{c(){t=A("li"),q(n.$$.fragment),e=P(),this.h()},l(s){t=C(s,"LI",{class:!0});var o=O(t);F(n.$$.fragment,o),e=U(o),o.forEach(k),this.h()},h(){$(t,"class","flex w-full flex-col items-center gap-2")},m(s,o){W(s,t,o),j(n,t,null),v(t,e),r=!0},p(s,o){const c={};o[0]&64&&(c.audioUrl=s[33].audio_url),o[0]&64&&(c.id=s[33].id),n.$set(c)},i(s){r||(g(n.$$.fragment,s),r=!0)},o(s){h(n.$$.fragment,s),r=!1},d(s){s&&k(t),R(n)}}}function ft(l){let t,n,e,r,s,o,c,a,i,p,f,_,E,M,S,Q,D,G,ee,V,I,z,K,te,x,L,w,y,J,ne,oe;n=new Ke({props:{src:"/banners/music.webp",title:"You Are <br/> A Musician.",titleLocation:"left",name:"suno"}});function _e(u){l[18](u)}let ie={areAdvanced:!0,className:"ml-auto"};l[1]!==void 0&&(ie.currentTabID=l[1]),s=new Re({props:ie}),ve.push(()=>we(s,"currentTabID",_e));function de(u){l[19](u)}let ue={inputs:l[15],currentTabID:l[1]};l[3]!==void 0&&(ue.formValues=l[3]),M=new He({props:ue}),ve.push(()=>we(M,"formValues",de)),G=new ke({props:{fullWidth:!0,variant:"outlined",type:"button",$$slots:{default:[Xe]},$$scope:{ctx:l}}}),G.$on("click",l[20]);const d=[et,Ze],b=[];function Y(u,m){return u[0].isAuthenticated?1:0}V=Y(l),I=b[V]=d[V](l);let T=l[13].md&&Ee();const ae=[it,ot],H=[];function N(u,m){return u[4]?0:u[5]?1:-1}return~(w=N(l))&&(y=H[w]=ae[w](l)),{c(){t=A("div"),q(n.$$.fragment),e=P(),r=A("div"),q(s.$$.fragment),c=P(),a=A("form"),i=A("input"),p=P(),f=A("input"),E=P(),q(M.$$.fragment),Q=P(),D=A("div"),q(G.$$.fragment),ee=P(),I.c(),te=P(),T&&T.c(),x=P(),L=A("div"),y&&y.c(),this.h()},l(u){t=C(u,"DIV",{class:!0});var m=O(t);F(n.$$.fragment,m),e=U(m),r=C(m,"DIV",{class:!0});var X=O(r);F(s.$$.fragment,X),c=U(X),a=C(X,"FORM",{class:!0,method:!0,action:!0});var B=O(a);i=C(B,"INPUT",{type:!0,name:!0}),p=U(B),f=C(B,"INPUT",{type:!0,name:!0}),E=U(B),F(M.$$.fragment,B),Q=U(B),D=C(B,"DIV",{class:!0});var Z=O(D);F(G.$$.fragment,Z),ee=U(Z),I.l(Z),Z.forEach(k),B.forEach(k),X.forEach(k),te=U(m),T&&T.l(m),x=U(m),L=C(m,"DIV",{class:!0});var re=O(L);y&&y.l(re),re.forEach(k),m.forEach(k),this.h()},h(){$(i,"type","hidden"),$(i,"name","signature"),i.value=l[12],$(f,"type","hidden"),$(f,"name","message"),f.value=_=JSON.stringify(l[11]),$(D,"class","ml-auto mt-6 flex flex w-full max-w-80 gap-2"),$(a,"class","flex flex-col gap-3"),$(a,"method","POST"),$(a,"action",z=l[1]==="essential"?"?/generateEssential":"?/generateAdvanced"),$(r,"class","flex flex-col gap-6 px-4 md:px-0"),$(L,"class","flex flex-col items-stretch gap-4"),$(t,"class","flex flex-col gap-8")},m(u,m){W(u,t,m),j(n,t,null),v(t,e),v(t,r),j(s,r,null),v(r,c),v(r,a),v(a,i),v(a,p),v(a,f),v(a,E),j(M,a,null),v(a,Q),v(a,D),j(G,D,null),v(D,ee),b[V].m(D,null),v(t,te),T&&T.m(t,null),v(t,x),v(t,L),~w&&H[w].m(L,null),J=!0,ne||(oe=Be(K=Oe.call(null,a,l[22])),ne=!0)},p(u,m){const X={};!o&&m[0]&2&&(o=!0,X.currentTabID=u[1],$e(()=>o=!1)),s.$set(X),(!J||m[0]&4096)&&(i.value=u[12]),(!J||m[0]&2048&&_!==(_=JSON.stringify(u[11])))&&(f.value=_);const B={};m[0]&2&&(B.currentTabID=u[1]),!S&&m[0]&8&&(S=!0,B.formValues=u[3],$e(()=>S=!1)),M.$set(B);const Z={};m[1]&32&&(Z.$$scope={dirty:m,ctx:u}),G.$set(Z);let re=V;V=Y(u),V===re?b[V].p(u,m):(se(),h(b[re],1,1,()=>{b[re]=null}),le(),I=b[V],I?I.p(u,m):(I=b[V]=d[V](u),I.c()),g(I,1),I.m(D,null)),(!J||m[0]&2&&z!==(z=u[1]==="essential"?"?/generateEssential":"?/generateAdvanced"))&&$(a,"action",z),K&&Se(K.update)&&m[0]&1940&&K.update.call(null,u[22]),u[13].md?T||(T=Ee(),T.c(),T.m(t,x)):T&&(T.d(1),T=null);let me=w;w=N(u),w===me?~w&&H[w].p(u,m):(y&&(se(),h(H[me],1,1,()=>{H[me]=null}),le()),~w?(y=H[w],y?y.p(u,m):(y=H[w]=ae[w](u),y.c()),g(y,1),y.m(L,null)):y=null)},i(u){J||(g(n.$$.fragment,u),g(s.$$.fragment,u),g(M.$$.fragment,u),g(G.$$.fragment,u),g(I),g(y),J=!0)},o(u){h(n.$$.fragment,u),h(s.$$.fragment,u),h(M.$$.fragment,u),h(G.$$.fragment,u),h(I),h(y),J=!1},d(u){u&&k(t),R(n),R(s),R(M),R(G),b[V].d(),T&&T.d(),~w&&H[w].d(),ne=!1,oe()}}}function _t(l,t,n){let e,r,s,o,c,a;ce(l,Te,d=>n(0,s=d)),ce(l,ze,d=>n(25,o=d)),ce(l,pe,d=>n(26,c=d)),ce(l,je,d=>n(13,a=d));let i="essential",p="Generate",f={},_,E,M,S=[],Q,D=0,G;const ee={prompt:"",make_instrumental:!1,tags:"",title:""},V={essential:{prompt:{description:"Text to sing.",required:!1,title:"Text",type:"string","x-order":0},make_instrumental:{description:"Instrumental description",required:!1,title:"Instrumental",type:"boolean","x-order":1}},advanced:{title:{description:"Text to sing.",required:!1,title:"Title",type:"string","x-order":2},tags:{description:"Text to sing.",required:!1,title:"Style of music",type:"string","x-order":2}}};let I="",z,K;const te=()=>{n(4,_=!0),n(2,p="Generating..."),n(9,D=0),n(10,I=""),x(),z=setInterval(w,100),K=setInterval(y,5e3)},x=()=>{clearInterval(K),clearInterval(z),clearInterval(G)},L=d=>{x(),n(4,_=!1),n(5,E=!1),n(6,M=null),n(2,p="Generate"),d.includes("Insufficient NFNT balance")||d.includes("Insufficient balance")?ge(Je):ge(Ye,{message:d})},w=()=>{n(9,D+=.1),D>10&&D<=30?n(10,I="Patience is a virtue"):D>30&&n(10,I="Some models can take long time to provide prediction, do not close this page and come back later. In next iteration we will add a system where you can not only view all your past generations, but be able to close page and come back to view result later.")},y=async()=>{if(S.length===0){L("No run IDs available");return}try{const d=S.map(N=>fetch(`/api/suno/generation_by_id?song_id=${N}`).then(u=>u.json())),b=await Promise.all(d),Y=b.filter(N=>N.status==="complete"),T=b.filter(N=>N.detail==="Not found"),ae=Y.length===S.length||Y.length+T.length===S.length,H=T.length===S.length;if(ae||H)if(x(),ae)n(6,M=Y),n(5,E=!0),n(4,_=!1),n(2,p="Generate"),J();else{const N=b.filter(u=>u.status==="failed").map(u=>u.error||"An error occurred during generation").join("; ");L(N)}else n(8,Q=b.map(N=>N.status).join(", "))}catch(d){L(d.message||"An error occurred while fetching the status")}},J=async()=>{try{const b=await(await fetch("/api/user/balance")).text();Te.updateCredits(b)}catch(d){console.error("Failed to update credits:",d)}},ne=d=>{_&&(d.preventDefault(),d.returnValue="")};Ge(()=>(pe.setById("music"),console.log(c),n(1,i=o.url.searchParams.get("tab")||"essential"),window.addEventListener("beforeunload",ne),()=>window.removeEventListener("beforeunload",ne))),Pe(()=>{xe.set(null),pe.setById(null)});function oe(d){i=d,n(1,i)}function _e(d){f=d,n(3,f)}const ie=()=>n(3,f={...ee}),de=()=>ge(Qe),ue=d=>(n(4,_=!0),n(8,Q="preparing request"),n(2,p="Generating..."),n(9,D=0),n(10,I=""),({result:b})=>{b.type==="success"?(n(8,Q=b.data.audio_files[0].status),n(7,S=b.data.audio_files.map(Y=>Y.id)),te()):L(b.data.error||"An error occurred during generation")});return l.$$.update=()=>{l.$$.dirty[0]&1&&n(12,e=(s==null?void 0:s.signature)||""),l.$$.dirty[0]&1&&n(11,r=(s==null?void 0:s.message)||"")},[s,i,p,f,_,E,M,S,Q,D,I,r,e,a,ee,V,te,L,oe,_e,ie,de,ue]}class It extends qe{constructor(t){super(),Fe(this,t,_t,ft,Ne,{},null,[-1,-1])}}export{It as component};
